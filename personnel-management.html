<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人员管理 - BMS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #1E6BFF;
            --bg-white: #FFFFFF;
            --bg-gray: #F5F7FA;
            --border-color: #E4E7ED;
            --text-primary: #303133;
            --text-regular: #606266;
            --text-secondary: #909399;
            --success-color: #67C23A;
            --warning-color: #E6A23C;
            --danger-color: #F56C6C;
            --info-color: #909399;
        }

        body {
            font-family: "Microsoft YaHei", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-gray);
            color: var(--text-primary);
        }

        /* 顶部导航栏 */
        .top-navbar {
            height: 60px;
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .brand-logo {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-blue);
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            position: relative;
        }

        .icon-btn:hover {
            background: var(--bg-gray);
        }

        .icon-btn svg {
            width: 20px;
            height: 20px;
            fill: var(--text-regular);
        }

        .icon-btn.has-badge::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: var(--danger-color);
            border-radius: 50%;
            border: 2px solid var(--bg-white);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .user-menu:hover {
            background: var(--bg-gray);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), #4589FF);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .user-name {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .dropdown-icon {
            width: 16px;
            height: 16px;
            fill: var(--text-regular);
            transition: transform 0.2s;
        }

        .user-menu.active .dropdown-icon {
            transform: rotate(180deg);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--bg-white);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
        }

        .user-menu.active .user-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-item:last-child {
            border-bottom: none;
            color: var(--danger-color);
        }

        .dropdown-item:hover {
            background: var(--bg-gray);
        }

        .dropdown-item svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        /* 左侧边栏 */
        .sidebar {
            width: 220px;
            background: var(--bg-white);
            border-right: 1px solid var(--border-color);
            position: fixed;
            left: 0;
            top: 60px;
            bottom: 0;
            overflow-y: auto;
            padding: 16px 0;
        }

        .menu-group {
            margin-bottom: 8px;
        }

        .menu-parent {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s;
        }

        .menu-parent:hover {
            background-color: var(--bg-gray);
        }

        .menu-parent.active {
            background-color: #E8F4FF;
            color: var(--primary-blue);
        }

        .menu-parent-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-parent svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .menu-arrow {
            width: 14px;
            height: 14px;
            transition: transform 0.3s;
            fill: var(--text-regular);
        }

        .menu-parent.expanded .menu-arrow {
            transform: rotate(90deg);
        }

        .menu-children {
            max-height: 0;
            overflow: hidden;
            padding-left: 20px;
            transition: max-height 0.3s ease;
        }

        .menu-children.show {
            max-height: 500px;
        }

        .menu-child {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .menu-child:hover {
            background-color: var(--bg-gray);
        }

        .menu-child.active {
            background-color: #E8F4FF;
            color: var(--primary-blue);
            font-weight: 500;
        }

        .menu-child.disabled {
            opacity: 0.2;
            cursor: not-allowed;
            pointer-events: none;
            color: var(--text-secondary);
        }

        /* 主内容区域 */
        .main-content {
            margin-left: 220px;
            margin-top: 60px;
            padding: 24px;
            min-height: calc(100vh - 60px);
        }

        .page-header {
            margin-bottom: 24px;
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        /* 内容卡片 */
        .content-card {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        /* 筛选区域 */
        .filter-section {
            display: flex;
            align-items: flex-end;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-label {
            font-size: 14px;
            color: var(--text-regular);
        }

        .filter-input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            width: 240px;
            outline: none;
            transition: border-color 0.3s;
        }

        .filter-input:focus {
            border-color: var(--primary-blue);
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            width: 180px;
            outline: none;
            cursor: pointer;
            transition: border-color 0.3s;
            background: var(--bg-white);
        }

        .filter-select:focus {
            border-color: var(--primary-blue);
        }

        .filter-btn {
            padding: 8px 20px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg-white);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-btn.primary {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .filter-btn.primary:hover {
            background: #0052E6;
            border-color: #0052E6;
        }

        .filter-btn.default:hover {
            background: var(--bg-gray);
        }

        /* 操作区域 */
        .action-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .action-left {
            display: flex;
            gap: 12px;
        }

        .action-btn {
            padding: 10px 20px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg-white);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn.primary {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .action-btn.primary:hover {
            background: #0052E6;
            border-color: #0052E6;
        }

        .action-btn.default:hover {
            background: var(--bg-gray);
        }

        .action-btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
            background: var(--bg-gray) !important;
            color: var(--text-secondary) !important;
            border-color: var(--border-color) !important;
        }

        /* 表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .data-table thead {
            background: var(--bg-gray);
        }

        .data-table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 500;
            font-size: 14px;
            color: var(--text-regular);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table td {
            padding: 16px;
            font-size: 14px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tbody tr {
            transition: background-color 0.3s;
        }

        .data-table tbody tr:hover {
            background-color: var(--bg-gray);
        }

        /* 状态标签 */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
        }

        .status-badge.active {
            background-color: #F0F9FF;
            color: var(--success-color);
        }

        .status-badge.inactive {
            background-color: #FEF0F0;
            color: var(--danger-color);
        }

        /* 角色标签 */
        .role-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            background: #E8F4FF;
            color: var(--primary-blue);
            margin-right: 6px;
        }

        /* 操作按钮 */
        .action-icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            color: var(--primary-blue);
            transition: all 0.3s;
            margin-right: 8px;
        }

        .action-icon-btn:hover {
            opacity: 0.7;
        }

        .action-icon-btn.delete {
            color: var(--danger-color);
        }

        .action-icon-btn svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .action-icon-btn:disabled {
            cursor: not-allowed;
            opacity: 0.2;
            color: var(--text-secondary) !important;
            pointer-events: none;
        }

        /* 分页 */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 20px;
        }

        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-white);
            cursor: pointer;
            font-size: 14px;
            color: var(--text-regular);
            transition: all 0.3s;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--bg-gray);
        }

        .pagination-btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .pagination-btn.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .pagination-info {
            font-size: 14px;
            color: var(--text-secondary);
            margin-right: 12px;
        }

        /* 用户头像 */
        .user-avatar-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .user-account {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* 站点标签 */
        .site-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .site-tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            background: var(--bg-gray);
            color: var(--text-regular);
        }

        /* 模态框样式 */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-white);
            border-radius: 8px;
            width: 600px;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .modal-btn {
            padding: 10px 24px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
            background: var(--bg-white);
        }

        .modal-btn.primary {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .modal-btn.primary:hover {
            background: #0052E6;
            border-color: #0052E6;
        }

        .modal-btn.danger {
            background: var(--danger-color);
            color: white;
            border-color: var(--danger-color);
        }

        .modal-btn.danger:hover {
            background: #F24545;
            border-color: #F24545;
        }

        .modal-btn.default:hover {
            background: var(--bg-gray);
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-regular);
            margin-bottom: 8px;
        }

        .form-label .required {
            color: var(--danger-color);
            margin-right: 4px;
        }

        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            border-color: var(--primary-blue);
        }

        .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
            background: var(--bg-white);
        }

        .form-select:focus {
            border-color: var(--primary-blue);
        }

        /* 多选下拉框样式 */
        .multi-select-container {
            position: relative;
        }

        .multi-select-display {
            min-height: 42px;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            background: var(--bg-white);
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
            transition: border-color 0.3s;
        }

        .multi-select-display:hover {
            border-color: var(--primary-blue);
        }

        .multi-select-display.focused {
            border-color: var(--primary-blue);
        }

        .multi-select-placeholder {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .multi-select-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: #E8F4FF;
            color: var(--primary-blue);
            border-radius: 4px;
            font-size: 13px;
        }

        .multi-select-tag-remove {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(30, 107, 255, 0.2);
            transition: background 0.2s;
        }

        .multi-select-tag-remove:hover {
            background: rgba(30, 107, 255, 0.3);
        }

        .multi-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            margin-top: 4px;
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 240px;
            overflow-y: auto;
            z-index: 10;
            display: none;
        }

        .multi-select-dropdown.active {
            display: block;
        }

        .multi-select-option {
            padding: 10px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .multi-select-option:hover {
            background: var(--bg-gray);
        }

        .multi-select-option input[type="checkbox"] {
            cursor: pointer;
        }

        /* 删除确认弹框 */
        .delete-modal {
            width: 450px;
        }

        .delete-warning {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .warning-icon {
            width: 48px;
            height: 48px;
            background: #FFF7E6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .warning-icon svg {
            width: 28px;
            height: 28px;
            fill: var(--warning-color);
        }

        .delete-message {
            flex: 1;
            padding-top: 8px;
        }

        .delete-message p {
            font-size: 15px;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .delete-message .personnel-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .error-text {
            color: var(--danger-color);
            font-weight: 500;
        }

        /* logo 设置弹框 */
        .logo-setting-modal {
            width: 400px;
        }

        .logo-upload-container {
            text-align: center;
        }

        .logo-upload-hint {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 16px;
        }

        .logo-upload-area {
            width: 200px;
            height: 80px;
            margin: 0 auto 16px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            background: var(--bg-gray);
        }

        .logo-upload-area:hover {
            border-color: var(--primary-blue);
            background: #E8F3FF;
        }

        .logo-upload-area.has-image {
            border-style: solid;
        }

        .logo-upload-area.error {
            border-color: var(--error-red);
            background: #FEF0F0;
        }

        .logo-upload-placeholder {
            color: var(--text-secondary);
            font-size: 14px;
            text-align: center;
            padding: 0 16px;
        }

        .logo-preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: none;
        }

        .logo-preview-image.show {
            display: block;
        }

        .logo-select-btn {
            padding: 8px 24px;
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 8px;
        }

        .logo-select-btn:hover {
            background: var(--bg-gray);
            border-color: var(--primary-blue);
        }

        .logo-upload-note {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .logo-upload-status {
            margin-top: 12px;
            font-size: 13px;
            display: none;
        }

        .logo-upload-status.success {
            color: var(--success-color);
            display: block;
        }

        .logo-upload-status.error {
            color: var(--danger-color);
            display: block;
        }

        .logo-upload-status svg {
            width: 16px;
            height: 16px;
            vertical-align: middle;
            margin-right: 4px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="top-navbar">
        <div class="navbar-left">
            <div class="brand-logo">
                <img src="logo.png" alt="AlwaysControl Technology" style="height: 40px; object-fit: contain;">
            </div>
        </div>
        <div class="navbar-right">
            <!-- 铃铛按钮 -->
            <button class="icon-btn has-badge" id="alarmBtn" title="告警通知" onclick="window.location.href='alarm-management.html'">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
                </svg>
            </button>
            <!-- 用户菜单 -->
            <div class="user-menu" onclick="toggleUserMenu()">
                <div class="user-avatar">管</div>
                <span class="user-name">管理员</span>
                <svg class="dropdown-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 10l5 5 5-5z"/>
                </svg>
                <div class="user-dropdown">
                    <div class="dropdown-item" onclick="openLogoSettingModal()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                        </svg>
                        logo 设置
                    </div>
                    <div class="dropdown-item" onclick="logout()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                        </svg>
                        退出登录
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 左侧边栏 -->
    <aside class="sidebar">
        <!-- 首页 -->
        <div class="menu-group">
            <div class="menu-parent" onclick="window.location.href='dashboard.html'">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span>首页</span>
                </div>
            </div>
        </div>

        <!-- 用户管理菜单组 -->
        <div class="menu-group">
            <div class="menu-parent" onclick="window.location.href='user-management.html'">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span>用户管理</span>
                </div>
            </div>
        </div>

        <div class="menu-group">
            <div class="menu-parent" onclick="toggleMenu(this)">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span>设备管理</span>
                </div>
                <svg class="menu-arrow" viewBox="0 0 24 24">
                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                </svg>
            </div>
            <div class="menu-children">
                <div class="menu-child" onclick="window.location.href='device-management.html'">
                    <span>设备列表</span>
                </div>
                <div class="menu-child" onclick="window.location.href='alarm-management.html'">
                    <span>告警管理</span>
                </div>
            </div>
        </div>

        <div class="menu-group">
            <div class="menu-parent expanded" onclick="toggleMenu(this)">
                <div class="menu-parent-left">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                    <span>系统管理</span>
                </div>
                <svg class="menu-arrow" viewBox="0 0 24 24">
                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                </svg>
            </div>
            <div class="menu-children show">
                <div class="menu-child disabled">
                    <span>角色管理</span>
                </div>
                <div class="menu-child active">
                    <span>人员管理</span>
                </div>
                <div class="menu-child disabled">
                    <span>操作日志</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- 主内容区域 -->
    <main class="main-content">
        <div class="page-header">
            <h1 class="page-title">人员管理</h1>
        </div>

        <div class="content-card">
            <!-- 筛选区域 -->
            <div class="filter-section">
                <div class="filter-item">
                    <input type="text" class="filter-input" id="userNameFilter" placeholder="搜索昵称/账号...">
                </div>
                <div class="filter-item">
                    <label class="filter-label">角色</label>
                    <select class="filter-select" id="roleFilter">
                        <option value="">全部角色</option>
                        <option value="admin">超级管理员</option>
                        <option value="operator">运维人员</option>
                        <option value="user">操作员</option>
                        <option value="guest">访客</option>
                    </select>
                </div>
                <button class="filter-btn primary" onclick="applyFilters()">
                    <span>查询</span>
                </button>
                <button class="filter-btn default" onclick="resetFilters()">
                    <span>重置</span>
                </button>
            </div>

            <!-- 操作区域 -->
            <div class="action-section">
                <div class="action-left">
                    <button class="action-btn primary" onclick="addPersonnel()" disabled>
                        <svg viewBox="0 0 24 24" style="width: 16px; height: 16px; fill: currentColor;">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        <span>新增人员</span>
                    </button>
                </div>
            </div>

            <!-- 数据表格 -->
            <table class="data-table">
                <thead>
                    <tr>
                        <th>昵称</th>
                        <th>账号</th>
                        <th>角色</th>
                        <th>状态</th>
                        <th>创建时间</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="personnelTableBody">
                    <!-- 数据通过JS动态渲染 -->
                </tbody>
            </table>

            <!-- 分页 -->
            <div class="pagination">
                <span class="pagination-info">共 <span id="totalCount">0</span> 条</span>
                <button class="pagination-btn" id="prevBtn" onclick="prevPage()">上一页</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn" onclick="goToPage(2)">2</button>
                <button class="pagination-btn" onclick="goToPage(3)">3</button>
                <button class="pagination-btn" id="nextBtn" onclick="nextPage()">下一页</button>
            </div>
        </div>
    </main>

    <!-- logo 设置弹框 -->
    <div class="modal-overlay" id="logoSettingModal">
        <div class="modal logo-setting-modal">
            <div class="modal-header">
                <h3 class="modal-title">logo 设置</h3>
                <button class="modal-close" onclick="closeLogoSettingModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="logo-upload-container">
                    <div class="logo-upload-hint">上传 logo 图片</div>

                    <div class="logo-upload-area" id="logoUploadArea" onclick="selectLogoImage()">
                        <div class="logo-upload-placeholder" id="logoPlaceholder">
                            点击或拖拽图片至此处
                        </div>
                        <img id="logoPreviewImage" class="logo-preview-image" alt="logo预览" />
                    </div>

                    <button type="button" class="logo-select-btn" onclick="selectLogoImage()">选择图片</button>

                    <div class="logo-upload-note">
                        支持格式:PNG/JPG,建议尺寸不超过 500×200px
                    </div>

                    <div class="logo-upload-status" id="logoUploadStatus">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span id="logoStatusText"></span>
                    </div>

                    <input type="file" id="logoFileInput" accept="image/png,image/jpeg,image/jpg" style="display: none;" onchange="handleLogoFileSelect(event)" />
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn default" onclick="closeLogoSettingModal()">取消</button>
                <button class="modal-btn primary" id="logoConfirmBtn" onclick="confirmLogoChange()" disabled>确认</button>
            </div>
        </div>
    </div>

    <!-- 新增人员弹框 -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">新增人员</h3>
                <button class="modal-close" onclick="closeAddModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addPersonnelForm">
                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>昵称</label>
                        <input type="text" class="form-input" id="add_nickname" placeholder="请输入昵称" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>账号</label>
                        <input type="text" class="form-input" id="add_account" placeholder="请输入账号" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>密码</label>
                        <input type="password" class="form-input" id="add_password" placeholder="请输入密码" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">角色</label>
                        <div class="multi-select-container" id="add_roles_container">
                            <div class="multi-select-display" onclick="toggleMultiSelect('add_roles')">
                                <span class="multi-select-placeholder">请选择角色</span>
                            </div>
                            <div class="multi-select-dropdown" id="add_roles_dropdown">
                                <div class="multi-select-option" onclick="selectRole('add', '超级管理员')">
                                    <input type="checkbox" id="add_role_admin" onchange="event.stopPropagation()">
                                    <label>超级管理员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('add', '运维人员')">
                                    <input type="checkbox" id="add_role_operator" onchange="event.stopPropagation()">
                                    <label>运维人员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('add', '操作员')">
                                    <input type="checkbox" id="add_role_user" onchange="event.stopPropagation()">
                                    <label>操作员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('add', '访客')">
                                    <input type="checkbox" id="add_role_guest" onchange="event.stopPropagation()">
                                    <label>访客</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">状态</label>
                        <select class="form-select" id="add_status">
                            <option value="active" selected>启用</option>
                            <option value="inactive">禁用</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn default" onclick="closeAddModal()">取消</button>
                <button class="modal-btn primary" onclick="savePersonnel()">保存</button>
            </div>
        </div>
    </div>

    <!-- 编辑人员弹框 -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">编辑人员</h3>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editPersonnelForm">
                    <input type="hidden" id="edit_personnelId">

                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>昵称</label>
                        <input type="text" class="form-input" id="edit_nickname" placeholder="请输入昵称" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>账号</label>
                        <input type="text" class="form-input" id="edit_account" placeholder="请输入账号" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label"><span class="required">*</span>密码</label>
                        <input type="password" class="form-input" id="edit_password" placeholder="请输入密码" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">角色</label>
                        <div class="multi-select-container" id="edit_roles_container">
                            <div class="multi-select-display" onclick="toggleMultiSelect('edit_roles')">
                                <span class="multi-select-placeholder">请选择角色</span>
                            </div>
                            <div class="multi-select-dropdown" id="edit_roles_dropdown">
                                <div class="multi-select-option" onclick="selectRole('edit', '超级管理员')">
                                    <input type="checkbox" id="edit_role_admin" onchange="event.stopPropagation()">
                                    <label>超级管理员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('edit', '运维人员')">
                                    <input type="checkbox" id="edit_role_operator" onchange="event.stopPropagation()">
                                    <label>运维人员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('edit', '操作员')">
                                    <input type="checkbox" id="edit_role_user" onchange="event.stopPropagation()">
                                    <label>操作员</label>
                                </div>
                                <div class="multi-select-option" onclick="selectRole('edit', '访客')">
                                    <input type="checkbox" id="edit_role_guest" onchange="event.stopPropagation()">
                                    <label>访客</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">状态</label>
                        <select class="form-select" id="edit_status">
                            <option value="active">启用</option>
                            <option value="inactive">禁用</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn default" onclick="closeEditModal()">取消</button>
                <button class="modal-btn primary" onclick="updatePersonnel()">保存</button>
            </div>
        </div>
    </div>

    <!-- 删除确认弹框 -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal delete-modal">
            <div class="modal-header">
                <h3 class="modal-title">删除确认</h3>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="delete-warning">
                    <div class="warning-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                        </svg>
                    </div>
                    <div class="delete-message">
                        <p>确定要删除人员 <span class="personnel-name" id="deletePersonnelName"></span> 吗?</p>
                        <p class="error-text">此操作不可撤销!</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn default" onclick="closeDeleteModal()">取消</button>
                <button class="modal-btn danger" onclick="confirmDelete()">确定删除</button>
            </div>
        </div>
    </div>

    <script>
        // 当前操作的人员ID(用于删除确认)
        let currentPersonnelId = null;

        // 角色选项映射
        const roleCheckboxMap = {
            '超级管理员': { add: 'add_role_admin', edit: 'edit_role_admin' },
            '运维人员': { add: 'add_role_operator', edit: 'edit_role_operator' },
            '操作员': { add: 'add_role_user', edit: 'edit_role_user' },
            '访客': { add: 'add_role_guest', edit: 'edit_role_guest' }
        };

        // 模拟数据 - 仅保留一条超级管理员记录
        const mockPersonnel = [
            {
                id: 1,
                nickname: '超级管理员',
                account: 'admin',
                avatar: '管',
                roles: ['超级管理员'],
                sites: ['北京站点', '上海站点', '深圳站点'],
                status: 'active',
                createTime: '2024-01-10 09:00:00'
            }
        ];

        // 渲染人员列表
        function renderPersonnelList() {
            const tbody = document.getElementById('personnelTableBody');
            const totalCount = document.getElementById('totalCount');

            totalCount.textContent = mockPersonnel.length;

            tbody.innerHTML = mockPersonnel.map(person => `
                <tr>
                    <td>
                        <div class="user-avatar-cell">
                            <div class="avatar">${person.avatar}</div>
                            <div class="user-details">
                                <span class="user-name">${person.nickname}</span>
                            </div>
                        </div>
                    </td>
                    <td>${person.account}</td>
                    <td>
                        ${person.roles.map(role => `<span class="role-tag">${role}</span>`).join('')}
                    </td>
                    <td>
                        <span class="status-badge ${person.status}">
                            ${person.status === 'active' ? '正常' : '停用'}
                        </span>
                    </td>
                    <td>${person.createTime}</td>
                    <td>
                        <button class="action-icon-btn" onclick="editPersonnel(${person.id})" title="编辑" disabled>
                            <svg viewBox="0 0 24 24">
                                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                            </svg>
                        </button>
                        <button class="action-icon-btn delete" onclick="deletePersonnel(${person.id})" title="删除" disabled>
                            <svg viewBox="0 0 24 24">
                                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                            </svg>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // 菜单切换
        function toggleMenu(element) {
            const isExpanded = element.classList.contains('expanded');
            const children = element.nextElementSibling;

            if (isExpanded) {
                element.classList.remove('expanded');
                children.classList.remove('show');
            } else {
                element.classList.add('expanded');
                children.classList.add('show');
            }
        }

        // 筛选功能
        function applyFilters() {
            const searchValue = document.getElementById('userNameFilter').value.toLowerCase();
            const roleValue = document.getElementById('roleFilter').value;
            console.log('应用筛选:', { searchValue, roleValue });
            // 实际项目中这里会调用API进行筛选
            alert('筛选功能：搜索 "' + searchValue + '" | 角色 "' + roleValue + '"');
        }

        function resetFilters() {
            document.getElementById('userNameFilter').value = '';
            document.getElementById('roleFilter').value = '';
            renderPersonnelList();
        }

        // ========== 多选下拉框相关函数 ==========

        // 切换多选下拉框
        function toggleMultiSelect(prefix) {
            const dropdown = document.getElementById(`${prefix}_dropdown`);
            const display = dropdown.previousElementSibling;

            dropdown.classList.toggle('active');
            display.classList.toggle('focused');

            // 关闭其他下拉框
            document.querySelectorAll('.multi-select-dropdown').forEach(dd => {
                if (dd.id !== `${prefix}_dropdown`) {
                    dd.classList.remove('active');
                    dd.previousElementSibling.classList.remove('focused');
                }
            });
        }

        // 选择角色
        function selectRole(prefix, roleName) {
            const checkboxId = roleCheckboxMap[roleName][prefix];
            const checkbox = document.getElementById(checkboxId);

            checkbox.checked = !checkbox.checked;
            updateRoleDisplay(prefix);
        }

        // 更新角色显示
        function updateRoleDisplay(prefix) {
            const display = document.querySelector(`#${prefix}_roles_container .multi-select-display`);
            const selectedRoles = getSelectedRoles(prefix);

            if (selectedRoles.length === 0) {
                display.innerHTML = '<span class="multi-select-placeholder">请选择角色</span>';
            } else {
                display.innerHTML = selectedRoles.map(role => `
                    <span class="multi-select-tag">
                        ${role}
                        <span class="multi-select-tag-remove" onclick="removeRole(event, '${prefix}', '${role}')">×</span>
                    </span>
                `).join('');
            }
        }

        // 移除角色
        function removeRole(event, prefix, roleName) {
            event.stopPropagation();
            const checkboxId = roleCheckboxMap[roleName][prefix];
            const checkbox = document.getElementById(checkboxId);
            checkbox.checked = false;
            updateRoleDisplay(prefix);
        }

        // 获取选中的角色
        function getSelectedRoles(prefix) {
            const selectedRoles = [];
            Object.keys(roleCheckboxMap).forEach(roleName => {
                const checkboxId = roleCheckboxMap[roleName][prefix];
                const checkbox = document.getElementById(checkboxId);
                if (checkbox && checkbox.checked) {
                    selectedRoles.push(roleName);
                }
            });
            return selectedRoles;
        }

        // 设置选中的角色
        function setSelectedRoles(prefix, roles) {
            // 先清空所有选择
            Object.keys(roleCheckboxMap).forEach(roleName => {
                const checkboxId = roleCheckboxMap[roleName][prefix];
                const checkbox = document.getElementById(checkboxId);
                if (checkbox) {
                    checkbox.checked = false;
                }
            });

            // 设置选中的角色
            roles.forEach(roleName => {
                const checkboxId = roleCheckboxMap[roleName][prefix];
                const checkbox = document.getElementById(checkboxId);
                if (checkbox) {
                    checkbox.checked = true;
                }
            });

            updateRoleDisplay(prefix);
        }

        // ========== 弹框操作函数 ==========

        // 打开新增人员弹框
        function addPersonnel() {
            // 清空表单
            document.getElementById('add_nickname').value = '';
            document.getElementById('add_account').value = '';
            document.getElementById('add_password').value = '';
            document.getElementById('add_status').value = 'active';

            // 清空角色选择
            setSelectedRoles('add', []);

            // 显示弹框
            document.getElementById('addModal').classList.add('active');
        }

        // 关闭新增人员弹框
        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
            // 关闭下拉框
            document.getElementById('add_roles_dropdown').classList.remove('active');
            document.querySelector('#add_roles_container .multi-select-display').classList.remove('focused');
        }

        // 保存新增人员
        function savePersonnel() {
            const nickname = document.getElementById('add_nickname').value.trim();
            const account = document.getElementById('add_account').value.trim();
            const password = document.getElementById('add_password').value.trim();
            const status = document.getElementById('add_status').value;
            const roles = getSelectedRoles('add');

            // 表单验证
            if (!nickname) {
                alert('请输入昵称');
                return;
            }
            if (!account) {
                alert('请输入账号');
                return;
            }
            if (!password) {
                alert('请输入密码');
                return;
            }

            // 生成新ID
            const newId = Math.max(...mockPersonnel.map(p => p.id)) + 1;

            // 创建新人员
            const newPersonnel = {
                id: newId,
                nickname: nickname,
                account: account,
                password: password, // 实际项目中需要加密存储
                avatar: nickname.charAt(0),
                roles: roles,
                sites: ['北京站点'], // 默认站点
                status: status,
                createTime: new Date().toISOString().slice(0, 19).replace('T', ' ')
            };

            // 添加到列表
            mockPersonnel.push(newPersonnel);

            // 刷新列表
            renderPersonnelList();

            // 关闭弹框
            closeAddModal();

            alert('人员创建成功!');
        }

        // 打开编辑人员弹框
        function editPersonnel(id) {
            const person = mockPersonnel.find(p => p.id === id);
            if (!person) return;

            // 填充表单数据
            document.getElementById('edit_personnelId').value = person.id;
            document.getElementById('edit_nickname').value = person.nickname;
            document.getElementById('edit_account').value = person.account;
            document.getElementById('edit_password').value = person.password || '';
            document.getElementById('edit_status').value = person.status;

            // 设置选中的角色
            setSelectedRoles('edit', person.roles || []);

            // 显示弹框
            document.getElementById('editModal').classList.add('active');
        }

        // 关闭编辑人员弹框
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
            // 关闭下拉框
            document.getElementById('edit_roles_dropdown').classList.remove('active');
            document.querySelector('#edit_roles_container .multi-select-display').classList.remove('focused');
        }

        // 保存编辑后的人员
        function updatePersonnel() {
            const personnelId = parseInt(document.getElementById('edit_personnelId').value);
            const nickname = document.getElementById('edit_nickname').value.trim();
            const account = document.getElementById('edit_account').value.trim();
            const password = document.getElementById('edit_password').value.trim();
            const status = document.getElementById('edit_status').value;
            const roles = getSelectedRoles('edit');

            // 表单验证
            if (!nickname) {
                alert('请输入昵称');
                return;
            }
            if (!account) {
                alert('请输入账号');
                return;
            }
            if (!password) {
                alert('请输入密码');
                return;
            }

            // 查找并更新人员
            const personIndex = mockPersonnel.findIndex(p => p.id === personnelId);
            if (personIndex !== -1) {
                mockPersonnel[personIndex].nickname = nickname;
                mockPersonnel[personIndex].account = account;
                mockPersonnel[personIndex].password = password; // 实际项目中需要加密存储
                mockPersonnel[personIndex].avatar = nickname.charAt(0);
                mockPersonnel[personIndex].status = status;
                mockPersonnel[personIndex].roles = roles;

                // 刷新列表
                renderPersonnelList();

                // 关闭弹框
                closeEditModal();

                alert('人员更新成功!');
            }
        }

        // 打开删除确认弹框
        function deletePersonnel(id) {
            const person = mockPersonnel.find(p => p.id === id);
            if (!person) return;

            // 设置当前操作的人员ID
            currentPersonnelId = id;

            // 显示人员名称
            document.getElementById('deletePersonnelName').textContent = person.nickname;

            // 显示弹框
            document.getElementById('deleteModal').classList.add('active');
        }

        // 关闭删除确认弹框
        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('active');
            currentPersonnelId = null;
        }

        // 确认删除人员
        function confirmDelete() {
            if (!currentPersonnelId) return;

            // 查找并删除人员
            const personIndex = mockPersonnel.findIndex(p => p.id === currentPersonnelId);
            if (personIndex !== -1) {
                mockPersonnel.splice(personIndex, 1);

                // 刷新列表
                renderPersonnelList();

                // 关闭弹框
                closeDeleteModal();

                alert('人员已删除!');
            }
        }

        // 分页功能
        function prevPage() {
            console.log('上一页');
        }

        function nextPage() {
            console.log('下一页');
        }

        function goToPage(page) {
            console.log('跳转到第', page, '页');
        }

        // 切换主题
        function toggleTheme() {
            console.log('切换主题');
            alert('主题切换功能');
        }

        // 切换语言
        function toggleLanguage() {
            console.log('切换语言');
            alert('语言切换功能');
        }

        // 切换用户菜单
        function toggleUserMenu() {
            const userMenu = document.querySelector('.user-menu');
            userMenu.classList.toggle('active');
        }

        // 退出登录
        function logout() {
            if (confirm('确定要退出登录吗？')) {
                console.log('退出登录');
                window.location.href = 'index.html';
            }
        }

        // 关闭用户菜单（点击页面其他地方时）
        document.addEventListener('click', function(event) {
            const userMenu = document.querySelector('.user-menu');
            if (userMenu && !userMenu.contains(event.target)) {
                userMenu.classList.remove('active');
            }
        });

        // ===== logo 设置相关功能 =====
        let selectedLogoFile = null;
        let selectedLogoDataURL = null;

        function openLogoSettingModal() {
            const modal = document.getElementById('logoSettingModal');
            modal.classList.add('active');
            const savedLogo = localStorage.getItem('customLogo');
            if (savedLogo) {
                showLogoPreview(savedLogo);
                enableConfirmButton();
            } else {
                resetLogoUpload();
            }
        }

        function closeLogoSettingModal() {
            document.getElementById('logoSettingModal').classList.remove('active');
            resetLogoUpload();
        }

        function resetLogoUpload() {
            selectedLogoFile = null;
            selectedLogoDataURL = null;
            const uploadArea = document.getElementById('logoUploadArea');
            const placeholder = document.getElementById('logoPlaceholder');
            const previewImage = document.getElementById('logoPreviewImage');
            const status = document.getElementById('logoUploadStatus');
            const confirmBtn = document.getElementById('logoConfirmBtn');
            uploadArea.classList.remove('has-image', 'error');
            placeholder.style.display = 'block';
            previewImage.classList.remove('show');
            status.className = 'logo-upload-status';
            confirmBtn.disabled = true;
        }

        function selectLogoImage() {
            document.getElementById('logoFileInput').click();
        }

        function handleLogoFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (!['image/png', 'image/jpeg', 'image/jpg'].includes(file.type)) {
                showLogoError('请上传 PNG/JPG 格式的图片');
                return;
            }
            if (file.size > 2 * 1024 * 1024) {
                showLogoError('图片大小不能超过 2MB');
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    if (img.width > 500 || img.height > 200) {
                        showLogoError('图片尺寸不能超过 500×200px');
                        return;
                    }
                    selectedLogoFile = file;
                    selectedLogoDataURL = e.target.result;
                    showLogoPreview(e.target.result);
                    showLogoSuccess('✓ 上传成功');
                    enableConfirmButton();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function showLogoPreview(dataURL) {
            const uploadArea = document.getElementById('logoUploadArea');
            const placeholder = document.getElementById('logoPlaceholder');
            const previewImage = document.getElementById('logoPreviewImage');
            uploadArea.classList.add('has-image');
            uploadArea.classList.remove('error');
            placeholder.style.display = 'none';
            previewImage.src = dataURL;
            previewImage.classList.add('show');
        }

        function showLogoError(message) {
            const uploadArea = document.getElementById('logoUploadArea');
            const status = document.getElementById('logoUploadStatus');
            const statusText = document.getElementById('logoStatusText');
            uploadArea.classList.add('error');
            status.className = 'logo-upload-status error';
            statusText.textContent = message;
            resetLogoUpload();
        }

        function showLogoSuccess(message) {
            const status = document.getElementById('logoUploadStatus');
            const statusText = document.getElementById('logoStatusText');
            status.className = 'logo-upload-status success';
            statusText.textContent = message;
        }

        function enableConfirmButton() {
            document.getElementById('logoConfirmBtn').disabled = false;
        }

        function confirmLogoChange() {
            if (!selectedLogoDataURL) {
                alert('请先选择图片');
                return;
            }
            localStorage.setItem('customLogo', selectedLogoDataURL);
            updateSystemLogo(selectedLogoDataURL);
            closeLogoSettingModal();
            alert('logo 设置成功!');
        }

        function updateSystemLogo(logoDataURL) {
            const brandLogoImg = document.querySelector('.brand-logo img');
            if (brandLogoImg) {
                brandLogoImg.src = logoDataURL;
            }
        }

        const logoUploadArea = document.getElementById('logoUploadArea');
        if (logoUploadArea) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                logoUploadArea.addEventListener(eventName, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });
            ['dragenter', 'dragover'].forEach(eventName => {
                logoUploadArea.addEventListener(eventName, () => {
                    logoUploadArea.style.borderColor = 'var(--primary-blue)';
                    logoUploadArea.style.background = 'var(--light-blue)';
                }, false);
            });
            ['dragleave', 'drop'].forEach(eventName => {
                logoUploadArea.addEventListener(eventName, () => {
                    logoUploadArea.style.borderColor = '';
                    logoUploadArea.style.background = '';
                }, false);
            });
            logoUploadArea.addEventListener('drop', function(e) {
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const fileInput = document.getElementById('logoFileInput');
                    fileInput.files = files;
                    handleLogoFileSelect({ target: fileInput });
                }
            }, false);
        }

        // 页面加载时渲染列表
        document.addEventListener('DOMContentLoaded', function() {
            renderPersonnelList();

            // 加载自定义 logo
            const savedLogo = localStorage.getItem('customLogo');
            if (savedLogo) {
                updateSystemLogo(savedLogo);
            }

            // 点击弹框背景关闭弹框
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', function(e) {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                        currentPersonnelId = null;
                        // 关闭所有多选下拉框
                        document.querySelectorAll('.multi-select-dropdown').forEach(dd => {
                            dd.classList.remove('active');
                            dd.previousElementSibling.classList.remove('focused');
                        });
                    }
                });
            });

            // 点击页面其他地方关闭多选下拉框
            document.addEventListener('click', function(e) {
                const isMultiSelectClick = e.target.closest('.multi-select-container');
                if (!isMultiSelectClick) {
                    document.querySelectorAll('.multi-select-dropdown').forEach(dd => {
                        dd.classList.remove('active');
                        dd.previousElementSibling.classList.remove('focused');
                    });
                }
            });
        });
    </script>
</body>
</html>
